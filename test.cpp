#include "Eigenkit/Eigenkit.h"

int main()
{
    ek::Matrix<double> m1 =
    {
        {0.8595, 0.7176, 0.9781, 0.8116, 0.2164},
        {0.8886, 0.05399,   0.2921,    0.7058,    0.1801},
        {0.8149, 0.367,     0.04329,   0.5527,    0.7479},
        {0.7431,    0.9701,    0.9428,    0.5411,    0.0009715},
        {0.8033,    0.8404,    0.9647,    0.9118,    0.8811},
        {0.05875,   0.4113,    0.03543,   0.1149,    0.8648},
        {0.7246,    0.3075,    0.4898,    0.8406,    0.5857},
        {0.538,    0.5798,    0.4514,   0.6041,    0.01276},
        {0.7342,    0.001529,  0.2108,    0.426,     0.5745},
        {0.6983,    0.7891,    0.4445,    0.2376,    0.1985}
    };

    ek::Bidiag<double> bd1(m1);
    bd1.GolubKahan();
    std::cout << bd1.U << std::endl;
    std::cout << "..." << std::endl;
    std::cout << bd1.L << std::endl;
    std::cout << "..." << std::endl;
    std::cout << bd1.V << std::endl;
    std::cout << "..." << std::endl;
    std::cout << bd1.U*bd1.L*bd1.V.h() << std::endl;

    return 0;
}
